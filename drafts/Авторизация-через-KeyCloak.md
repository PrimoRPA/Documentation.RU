<div style="background-color:#f2f2f2; padding:10px; border-radius:5px;">
  üìù Key—Åloak ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –∏ —Å–µ—Ä–≤–∏—Å–∞–º. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ OpenID Connect –∏ OAuth 2.0.
</div>

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Primo RPA

Primo RPA –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Keycloak:

- **–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –ø–æ—Ç–æ–∫** ‚Äî –∫–Ω–æ–ø–∫–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π *¬´–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –ø–æ—Ç–æ–∫¬ª*
- **–ü–æ—Ç–æ–∫ —Å PKCE (Proof Key for Code Exchange)** ‚Äî –∫–Ω–æ–ø–∫–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π *¬´–ü–æ—Ç–æ–∫ —Å PKCE¬ª*

–ù–∞ —Ñ–æ—Ä–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –∫–Ω–æ–ø–∫–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.  
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Keycloak –ø–µ—Ä–µ–¥–∞—ë—Ç —Ä–æ–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É ‚Äî –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

> ‚ö†Ô∏è –†–æ–ª–∏ Keycloak —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ **WebAPI**.

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Key—Åloak ‚Äî –≤ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Key—Åloak](https://www.keycloak.org/documentation) –∏ –≤ —Å—Ç–∞—Ç—å–µ [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Key—Åloak](https://docs.primo-rpa.ru/ru/orchestrator-new/orchestrator-sys-admin/keycloak-integration).



---

–°—Ç–∞—Ç—å—è https://docs.primo-rpa.ru/ru/primo-ai/developer/tutorial/authorization

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ –º–µ—Ç–æ–¥—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ `/auth` –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–µ—Å—Å–∏—è–º–∏.

| –ú–µ—Ç–æ–¥ | Endpoint | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|----------|------------|
| `POST` | `/auth/Account/logout` | –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–∏—Å—Ç–µ–º—ã. |
| `POST` | `/auth/Account/KeyCloak1/Login` | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ KeyCloak1 |
| `GET` | `/auth/Account/KeyCloak2/Login` | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ KeyCloak2. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `redirect_uri`. |
| `GET` | `/auth/Account/KeyCloak2/AuthUrl1` | –ü–æ–ª—É—á–µ–Ω–∏–µ AuthUrl –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ KeyCloak2. |

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

`GET /auth/account/type`

–í –æ—Ç–≤–µ—Ç–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç —á–∏—Å–ª–æ–≤–æ–π –∫–æ–¥:

- 0 ‚Äî –æ–±—ã—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- 1 ‚Äî Active Directory (AD)

- 2 ‚Äî OpenId

### –†–∞–±–æ—Ç–∞ —Å —Ä–æ–ª—è–º–∏ (v2)

–ú–µ—Ç–æ–¥—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ /api/Roles/v2 –∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ä–æ–ª–∏:

| –ú–µ—Ç–æ–¥ | Endpoint | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|----------|------------|
|`POST`|`/api/Roles/v2`|–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ä–æ–ª–∏|
|`PUT`|`/api/Roles/v2/{id}`|–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ id|




